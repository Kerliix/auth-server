<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title><%= title %></title>
  <link rel="stylesheet" href="/styles.css" />
</head>
<body>
  <div class="container">
    <h1>Authorize <%= client.name || client.clientId %></h1>
    <p><%= client.name || client.clientId %> is requesting access to your account.</p>
    <p>Requested scope: <strong><%= scope || 'None' %></strong></p>

    <form method="POST" action="/oauth/authorize/decision">
      <input type="hidden" name="transaction_id" value="<%= transactionID %>" />
      <input type="hidden" name="redirect_uri" value="<%= redirect_uri %>" />
      <input type="hidden" name="scope" value="<%= scope %>" />
      <input type="hidden" name="state" value="<%= state %>" />

      <!-- Include PKCE fields if present -->
      <% if (code_challenge && code_challenge_method) { %>
        <input type="hidden" name="code_challenge" value="<%= code_challenge %>" />
        <input type="hidden" name="code_challenge_method" value="<%= code_challenge_method %>" />
      <% } %>

      <button type="submit" name="allow" value="yes">Allow</button>
      <button type="submit" name="cancel" value="no">Deny</button>
    </form>
  </div>
</body>
</html>
